CUDA_VISIBLE_DEVICES=0 python3 fairseq_cli/train.py /media/hdd1/pam/mt/data/joint_multi_domain/medical/adaptive_retrieval/data-bin/ --log-interval 100 --log-format simple --arch transformer_wmt19_de_en_with_datastore --save-dir /media/hdd1/pam/mt/data/joint_multi_domain/medical/adaptive_retrieval/ --restore-file /media/hdd1/pam/mt/models/wmt19.de-en/wmt19.de-en.pt --reset-dataloader --reset-lr-scheduler --reset-meters --reset-optimizer --validate-interval-updates 100 --save-interval-updates 100 --keep-interval-updates 1 --max-update 5000 --validate-after-updates 1000 --save-interval 10000 --validate-interval 100 --keep-best-checkpoints 1 --no-epoch-checkpoints --no-last-checkpoints --no-save-optimizer-state --train-subset valid --valid-subset valid --source-lang de --target-lang en --criterion label_smoothed_cross_entropy --label-smoothing 0.001 --max-source-positions 1024 --max-target-positions 1024 --batch-size 16 --update-freq 1 --batch-size-valid 16 --task translation --optimizer adam --adam-betas "(0.9, 0.98)" --adam-eps 1e-08  --lr 0.0003 --clip-norm 1.0 --lr-scheduler reduce_lr_on_plateau --lr-patience 5 --lr-shrink 0.5 --patience 30 --max-epoch 500 --load-knn-datastore --dstore-filename /media/hdd1/pam/mt/data/joint_multi_domain/medical/datastore_32/ --use-knn-datastore --dstore-size 6903141 --probe 32 --knn-sim-func do_not_recomp_l2 --use-gpu-to-search --move-dstore-to-mem --no-load-keys --knn-lambda-type trainable --only-train-knn-parameters --lambda-cache-feat=/media/hdd1/pam/mt/data/joint_multi_domain/medical/adaptive_retrieval/


screen -dmS train_datastore_pca_subtitles sh -c 'export LD_PRELOAD=/home/pam/anaconda3/lib/libmkl_core.so:/home/pam/anaconda3/lib/libmkl_sequential.so; CUDA_VISIBLE_DEVICES=2 python3 train_datastore.py --dstore_mmap=/media/hdd1/pam/mt/data/joint_multi_domain/subtitles/datastore_32/ --dstore_size=153604142 --faiss_index=/media/hdd1/pam/mt/data/joint_multi_domain/subtitles/datastore_32/pca/knn_index_256 --pca=256; exec bash'